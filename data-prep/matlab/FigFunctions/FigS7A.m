%FigS7A.m
% Dynamic Table

function FigS7A(subj_figs,summary_data_path,nwb)
    clearvars -except subj_session_id summary_data_path subj_figs primary_experiments_table subj nwb output_path
    if contains(subj_figs,' S7a')
    
        load(strcat(summary_data_path, "\IndividualFigures\FigS7\S7A\h1.mat"));
        
        label_x={'F7','F2-2','F2','M4','F3','M2','F9','F10', 'M3'}';
        %Try saving h1{1,1} directly in dynamic table (include NaN values).
        %Assign to dynamic table
        train = h1{1,1};
        test = h1{2,1};
        col1 = types.hdmf_common.VectorData( ...
            'description', label_x{1}, ...
            'data', train(:,1));
        col1_len = length(col1.data);
        col2 = types.hdmf_common.VectorData( ...
            'description', label_x{2}, ...
            'data', train(:,2));
        col3 = types.hdmf_common.VectorData( ...
            'description', label_x{3}, ...
            'data', train(:,3));
        col4 = types.hdmf_common.VectorData( ...
            'description', label_x{4}, ...
            'data', train(:,4));
        col5 = types.hdmf_common.VectorData( ...
            'description', label_x{5}, ...
            'data', train(:,5));
        col6 = types.hdmf_common.VectorData( ...
            'description', label_x{6}, ...
            'data', train(:,6));
        col7 = types.hdmf_common.VectorData( ...
            'description', label_x{7}, ...
            'data', train(:,7));
        col8 = types.hdmf_common.VectorData( ...
            'description', label_x{8}, ...
            'data', train(:,8));
        col9 = types.hdmf_common.VectorData( ...
            'description', label_x{9}, ...
            'data', train(:,9));
    
        table_S7A_train = types.hdmf_common.DynamicTable( ...
            'description', 'analysis table', ...
            label_x{1}, col1, ...
            label_x{2}, col2, ...
            label_x{3}, col3, ...
            label_x{4}, col4, ...
            label_x{5}, col5, ...
            label_x{6}, col6, ...
            label_x{7}, col7, ...
            label_x{8}, col8, ...
            label_x{9}, col9, ...
            'id', types.hdmf_common.ElementIdentifiers('data', linspace(1,col1_len,col1_len)) ...
            );
        nwb.analysis.set('GRaFTRsquareRestNeuronsFromVesselsTrainS7A', table_S7A_train);
    
        %TESTING DATA
        col1 = types.hdmf_common.VectorData( ...
            'description', label_x{1}, ...
            'data', test(:,1));
        col1_len = length(col1.data);
        col2 = types.hdmf_common.VectorData( ...
            'description', label_x{2}, ...
            'data', test(:,2));
        col3 = types.hdmf_common.VectorData( ...
            'description', label_x{3}, ...
            'data', test(:,3));
        col4 = types.hdmf_common.VectorData( ...
            'description', label_x{4}, ...
            'data', test(:,4));
        col5 = types.hdmf_common.VectorData( ...
            'description', label_x{5}, ...
            'data', test(:,5));
        col6 = types.hdmf_common.VectorData( ...
            'description', label_x{6}, ...
            'data', test(:,6));
        col7 = types.hdmf_common.VectorData( ...
            'description', label_x{7}, ...
            'data', test(:,7));
        col8 = types.hdmf_common.VectorData( ...
            'description', label_x{8}, ...
            'data', test(:,8));
        col9 = types.hdmf_common.VectorData( ...
            'description', label_x{9}, ...
            'data', test(:,9));
    
        table_S7A_test = types.hdmf_common.DynamicTable( ...
            'description', 'analysis table', ...
            label_x{1}, col1, ...
            label_x{2}, col2, ...
            label_x{3}, col3, ...
            label_x{4}, col4, ...
            label_x{5}, col5, ...
            label_x{6}, col6, ...
            label_x{7}, col7, ...
            label_x{8}, col8, ...
            label_x{9}, col9, ...
            'id', types.hdmf_common.ElementIdentifiers('data', linspace(1,col1_len,col1_len)) ...
            );
        nwb.analysis.set('GRaFTRsquareRestNeuronsFromVesselsTestS7A', table_S7A_test);
    
    end
end