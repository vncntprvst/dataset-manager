%Fig5A.m

function Fig5A(subj_figs,summary_data_path,nwb)
    clearvars -except subj_session_id summary_data_path subj_figs primary_experiments_table subj nwb output_path
    if contains(subj_figs,' 5a')
        
        table = readtable(strcat(summary_data_path,'\IndividualFigures\Fig5\A\PAPhasevsFreq_5A.csv'));
        f_stim = table.f_stim;
        phi_stim = table.phi_stim;
        phistd_stim = table.phistd_stim;
    
        %Create dynamic table
        col1 = types.hdmf_common.VectorData( ...
            'description', 'Frequency (Hz)', ...
            'data', f_stim);
        col1_len = length(col1.data);
        col2 = types.hdmf_common.VectorData( ...
            'description', 'Phase (rad)', ...
            'data', phi_stim);
        col3 = types.hdmf_common.VectorData( ...
            'description', 'Phase SD (rad)', ...
            'data', phistd_stim);
        table_5A_phase = types.hdmf_common.DynamicTable( ...
            'description', 'analysis table', ...
            'Frequency', col1, ...
            'Phase', col2, ...
            'Phase SD',col3,...
            'id', types.hdmf_common.ElementIdentifiers('data', linspace(1,col1_len,col1_len)) ...
            );
        nwb.analysis.set('PAStimPhase5A', table_5A_phase);
    
    
        table = readtable(strcat(summary_data_path,'\IndividualFigures\Fig5\A\PAResidSpec_5A.csv'));
        f = table.f;
        Sresid = table.Sresid;
    
        %Create dynamic table
        col1 = types.hdmf_common.VectorData( ...
            'description', 'Frequency (Hz)', ...
            'data', f);
        col1_len = length(col1.data);
        col2 = types.hdmf_common.VectorData( ...
            'description', 'Shallow PA Residual Power', ...
            'data', Sresid);
        table_5A_spectrum = types.hdmf_common.DynamicTable( ...
            'description', 'analysis table', ...
            'Frequency', col1, ...
            'Phase', col2, ...
            'id', types.hdmf_common.ElementIdentifiers('data', linspace(1,col1_len,col1_len)) ...
            );
        nwb.analysis.set('PAStimSpectrum5A', table_5A_spectrum);
    
    
        
        table = readtable(strcat(summary_data_path,'\IndividualFigures\Fig5\A\PAExtractedAmps_5A.csv'));
        xlocs = table.xlocs;
        ylocs = table.ylocs;
        V = table.V;
    
        %Create dynamic table
        col1 = types.hdmf_common.VectorData( ...
            'description', 'Extracted Freqs (Hz)', ...
            'data', xlocs);
        col1_len = length(col1.data);
        col2 = types.hdmf_common.VectorData( ...
            'description', 'Shallow PA Residual Power at Extracted Freqs', ...
            'data', ylocs);
        col3 = types.hdmf_common.VectorData( ...
            'description', 'Shallow PA Extracted Power at Extracted Freqs', ...
            'data', V);
        table_5A_extractedpower = types.hdmf_common.DynamicTable( ...
            'description', 'analysis table', ...
            'Extracted Frequency', col1, ...
            'Residual Power', col2, ...
            'Extracted Power',col3,...
            'id', types.hdmf_common.ElementIdentifiers('data', linspace(1,col1_len,col1_len)) ...
            );
        nwb.analysis.set('PAStimExtractedPower5A', table_5A_extractedpower);
    end
end