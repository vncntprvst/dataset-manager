%FigS2A.m
% Dynamic Table

function FigS2A(subj_figs,summary_data_path,nwb)
    clearvars -except subj_session_id summary_data_path subj_figs primary_experiments_table subj nwb output_path
    if contains(subj_figs,' S2a')

        table = readtable(strcat(summary_data_path,'\IndividualFigures\FigS2\A\FigS2A_allcorr.csv'));
        corr = table.AllCorr;
        table = readtable(strcat(summary_data_path,'\IndividualFigures\FigS2\A\FigS2A_Lag.csv'));
        
        Lags = table.Filt_Lags;
        col1 = types.hdmf_common.VectorData( ...
            'description', 'Flux-Diameter Corr', ...
            'data', corr);
        col1_len = length(col1.data);
        table_S2A_Corr = types.hdmf_common.DynamicTable( ...
            'description', 'analysis table', ...
            'Flux-Diameter Corr', col1, ...
            'id', types.hdmf_common.ElementIdentifiers('data', linspace(1,col1_len,col1_len)) ...
            );
        nwb.analysis.set('FluxDiamCorrRestS2A', table_S2A_Corr);
    
        col1 = types.hdmf_common.VectorData( ...
            'description', 'Flux-Diameter lag (s)', ...
            'data', Lags);
        col1_len = length(col1.data);
        table_S2A_Lag = types.hdmf_common.DynamicTable( ...
            'description', 'analysis table', ...
            'Flux-Diameter Lag (s)', col1, ...
            'id', types.hdmf_common.ElementIdentifiers('data', linspace(1,col1_len,col1_len)) ...
            );
        nwb.analysis.set('FluxDiamLagRestS2A', table_S2A_Lag);
        close all;
    end
end