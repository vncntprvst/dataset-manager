%FigS2H.m

function FigS2H(subj_figs,summary_data_path,nwb)
    clearvars -except subj_session_id summary_data_path subj_figs primary_experiments_table subj nwb output_path
    if contains(subj_figs,' S2h')
        clearvars -except subj_session_id summary_data_path subj_figs primary_experiments_table subj nwb output_path
    
        table = readtable(strcat(summary_data_path,'\IndividualFigures\FigS2\H\PARMSradiuschange_S2H.csv'));
        PA_AvgR = table.PA_AvgR;
        PA_RMSdR = table.PA_RMSdR;
    
        col1 = types.hdmf_common.VectorData( ...
            'description', 'PA Average diameter (um)', ...
            'data', PA_AvgR);
        col1_len = length(col1.data);
        col2 = types.hdmf_common.VectorData( ...
            'description', 'PA Norm RMS diameter change', ...
            'data', PA_RMSdR);
        table_S2H_RMSd_PA = types.hdmf_common.DynamicTable( ...
            'description', 'analysis table', ...
            'PA Average diameter (um)', col1, ...
            'PA Norm RMS diameter change', col2, ...
            'id', types.hdmf_common.ElementIdentifiers('data', linspace(1,col1_len,col1_len)) ...
            );
        nwb.analysis.set('PAHeartRateRMSDiameterChangeS2H', table_S2H_RMSd_PA);
    
        table = readtable(strcat(summary_data_path,'\IndividualFigures\FigS2\H\PiaRMSradiuschange_S2H.csv'));
        Pia_AvgR = table.Pia_AvgR;
        Pia_RMSdR = table.Pia_RMSdR;
    
        col1 = types.hdmf_common.VectorData( ...
            'description', 'Pia Average diameter (um)', ...
            'data', Pia_AvgR);
        col1_len = length(col1.data);
        col2 = types.hdmf_common.VectorData( ...
            'description', 'Pia Norm RMS diameter change', ...
            'data', Pia_RMSdR);
        table_S2H_RMSd_Pia = types.hdmf_common.DynamicTable( ...
            'description', 'analysis table', ...
            'Pia Average diameter (um)', col1, ...
            'Pia Norm RMS diameter change', col2, ...
            'id', types.hdmf_common.ElementIdentifiers('data', linspace(1,col1_len,col1_len)) ...
            );
        nwb.analysis.set('PiaHeartRateRMSDiameterChangeS2H', table_S2H_RMSd_Pia);
        close all;
    end
end